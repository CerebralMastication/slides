<!DOCTYPE html>
<html>
  <head>
    <title>Manipulation</title>
    <meta charset="utf-8">
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <link href="libs/pagedtable/css/pagedtable.css" rel="stylesheet" />
    <script src="libs/pagedtable/js/pagedtable.js"></script>
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Manipulation

---


class: dv

# Manipulation using dplyr and tidyr 

* Three topics

  * Data transformation (verbs)
  
  * The pipe
  
  * Data tidying
  
---

class: dv

# Data - flights from nycflights13
  



```r
flights
```
  

```
## # A tibble: 328,521 x 7
##    year month   day dep_time sched_dep_time carrier distance
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;   &lt;chr&gt;    &lt;int&gt;
## 1  2013     1     1      317            315      UA     1400
## 2  2013     1     1      333            329      UA     1416
## 3  2013     1     1      342            340      AA     1089
## 4  2013     1     1      344            345      B6     1576
## 5  2013     1     1      354            360      DL      762
## 6  2013     1     1      354            358      UA      719
## # ... with 3.285e+05 more rows
```

---

class: dv

# select() columns

&lt;br&gt;
&lt;br&gt;

![](img/select.png)


---

class: dv

# select() columns

* Select `year` and `carrier`


```r
select(.data = flights, year, carrier)
```

```
## # A tibble: 328,521 x 2
##    year carrier
##   &lt;int&gt;   &lt;chr&gt;
## 1  2013      UA
## 2  2013      UA
## 3  2013      AA
## 4  2013      B6
## 5  2013      DL
## 6  2013      UA
## # ... with 3.285e+05 more rows
```

---

class: dv

# The pipe %&gt;%

--

.pull-left[

* The _object_ to the left of the pipe becomes the _first argument_ of the function on the right

* Take `x` _and then_ do `f` to it

![](./img/pipe.png)

]

--

.pull-right[


```r
# Readability is the 
# focus of the pipe!

flights %&gt;%
  select(dep_time) %&gt;%
  head(4)
```

```
## # A tibble: 4 x 1
##   dep_time
##      &lt;dbl&gt;
## 1      317
## 2      333
## 3      342
## 4      344
```

```r
# depart &lt;- select(flights, dep_time)
# head(depart 4)
```

]

---

class: dv

# The pipe %&gt;%

.pull-left[

* The _object_ to the left of the pipe becomes the _first argument_ of the function on the right

* Take `x` _and then_ do `f` to it

![](./img/pipe.png)

]

.pull-right[

![](img/pipeitup.jpg)

]

---

class: dv

# filter() for specific rows

&lt;br&gt;
&lt;br&gt;

![](img/filter.png)

---

class: dv

# filter() for specific rows

* Only American Airlines flights? (In Excel, might add a _filter_ on the table)


```r
AA &lt;- filter(flights, carrier == "AA")
head(AA, 2)
```

```
## # A tibble: 2 x 7
##    year month   day dep_time sched_dep_time carrier distance
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;   &lt;chr&gt;    &lt;int&gt;
## 1  2013     1     1      342            340      AA     1089
## 2  2013     1     1      358            360      AA      733
```

--


```r
# With pipes
flights %&gt;%
  filter(carrier == "AA") %&gt;%
  head(2)
```

```
## # A tibble: 2 x 7
##    year month   day dep_time sched_dep_time carrier distance
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;   &lt;chr&gt;    &lt;int&gt;
## 1  2013     1     1      342            340      AA     1089
## 2  2013     1     1      358            360      AA      733
```

---

class: dv

# A question

.pull-left[

* Can we categorize flights as:

  * early
  
  * late 
  
  * really late
  
]

.pull-right[

* Can we quantify "late" and "really late"?
  
]




```r
flights %&gt;% select(dep_time, sched_dep_time)
```


```
## # A tibble: 328,521 x 2
##   dep_time sched_dep_time
##      &lt;dbl&gt;          &lt;dbl&gt;
## 1      317            315
## 2      333            329
## 3      342            340
## 4      344            345
## 5      354            360
## 6      354            358
## # ... with 3.285e+05 more rows
```

---

class: dv

# mutate() to add new columns

&lt;br&gt;
&lt;br&gt;

![](img/mutate.png)


---

class: dv

# mutate() to add new columns


```r
flights_late &lt;- flights %&gt;%
  mutate(delay = dep_time - sched_dep_time)

flights_late
```

```
## # A tibble: 328,521 x 8
##    year month   day dep_time sched_dep_time carrier distance delay
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;          &lt;dbl&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;
## 1  2013     1     1      317            315      UA     1400     2
## 2  2013     1     1      333            329      UA     1416     4
## 3  2013     1     1      342            340      AA     1089     2
## 4  2013     1     1      344            345      B6     1576    -1
## 5  2013     1     1      354            360      DL      762    -6
## 6  2013     1     1      354            358      UA      719    -4
## # ... with 3.285e+05 more rows
```

--

* Negative delay = "early"

---

class: dv

# mutate() to add new columns

* Of the flights that are late, define the 75th percentile to be "really late"

* How late is the 75th percentile?


```r
flights_late %&gt;%
  filter(delay &gt; 0) %&gt;%  # Ignore flights that were early
  pull(delay) %&gt;%        # Pull only the delay column
  quantile()             # Calculate the quantiles
```

```
##   0%  25%  50%  75% 100% 
##    1    6   19   50 1301
```

---

class: dv

# Three "cases" to categorize

* Case 1: 

  * IF `delay &lt;= 0`
  
  * THEN `early`
  
* Case 2: 
  
  * IF `delay &lt;= 50` 
  
  * THEN `late`
  
* Case 3: 
  
  * OTHERWISE `really late`

---

class: dv

# How might we do this in Excel?

* First attempt (H2 = delay column)


```r
=IF(H2 &lt;= 0, "early", IF(AND(H2&gt;0, H2&lt;=50), "late", IF(H2&gt;50,"really late")))
```

--

* If you know about ALT+ENTER to align nicely


```r
=IF(H2 &lt;= 0,           "early", 
 IF(AND(H2&gt;0, H2&lt;=50), "late", 
 IF(H2&gt;50,             "really late")))
```

--

* If you understand that the order matters


```r
=IF(H2&lt;=0, "early",
 IF(H2&lt;=50,"late",
           "really late"))
```

---

class: dv

# Even Excel knows the deal

--

* Error prone:

  * "It might work 75% of the time, but return unexpected results 25% of the time. _Unfortunately, the odds of you catching the 25% are slim._"

--

* Maintenance / Documentation

  * "Multiple IF statements can become incredibly difficult to maintain, _especially when you come back some time later and try to figure out what you, or worse someone else, was trying to do._"
  
  * No comments in the cell

--

* Speed

  * They are really slow. &gt;1 second for 3 conditions and ~320,000 rows

--

* Just don't

  * "If you find yourself with an IF statement that just seems to keep growing with no end in sight, _itâ€™s time to put down the mouse and rethink your strategy._"


---

class: dv

# mutate() and case_when()


```r
flights_cat &lt;- flights_late %&gt;% 
  mutate(
    
    # Separate the flights into 3 categories
    late_category = case_when(
      delay &lt;= 0   ~ "early",             # Early if negative delay
      delay &lt;= 50  ~ "late",              # Late if below 75th percentile
      TRUE         ~ "really late")) %&gt;%  # Really late otherwise
  
  # Only select relevant columns
  select(dep_time, sched_dep_time, delay, late_category)
```



```
##    user  system elapsed 
##    0.03    0.02    0.04
```

--

&lt;br&gt;&lt;/br&gt;

* Readability / Comments

* Scalable / Speed

---

class: dv

# mutate() and case_when()

&lt;div data-pagedtable="false"&gt;
  &lt;script data-pagedtable-source type="application/json"&gt;
{"columns":[{"label":["dep_time"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sched_dep_time"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["delay"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["late_category"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"317","2":"315","3":"2","4":"late"},{"1":"333","2":"329","3":"4","4":"late"},{"1":"342","2":"340","3":"2","4":"late"},{"1":"344","2":"345","3":"-1","4":"early"},{"1":"354","2":"360","3":"-6","4":"early"},{"1":"354","2":"358","3":"-4","4":"early"},{"1":"355","2":"360","3":"-5","4":"early"},{"1":"357","2":"360","3":"-3","4":"early"},{"1":"357","2":"360","3":"-3","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"359","2":"360","3":"-1","4":"early"},{"1":"359","2":"359","3":"0","4":"early"},{"1":"359","2":"360","3":"-1","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"361","2":"360","3":"1","4":"late"},{"1":"362","2":"370","3":"-8","4":"early"},{"1":"362","2":"365","3":"-3","4":"early"},{"1":"366","2":"370","3":"-4","4":"early"},{"1":"366","2":"370","3":"-4","4":"early"},{"1":"367","2":"367","3":"0","4":"early"},{"1":"368","2":"360","3":"8","4":"late"},{"1":"371","2":"360","3":"11","4":"late"},{"1":"373","2":"370","3":"3","4":"late"},{"1":"375","2":"375","3":"0","4":"early"},{"1":"375","2":"375","3":"0","4":"early"},{"1":"382","2":"390","3":"-8","4":"early"},{"1":"383","2":"370","3":"13","4":"late"},{"1":"383","2":"387","3":"-4","4":"early"},{"1":"384","2":"390","3":"-6","4":"early"},{"1":"384","2":"390","3":"-6","4":"early"},{"1":"387","2":"390","3":"-3","4":"early"},{"1":"388","2":"390","3":"-2","4":"early"},{"1":"388","2":"390","3":"-2","4":"early"},{"1":"389","2":"390","3":"-1","4":"early"},{"1":"389","2":"390","3":"-1","4":"early"},{"1":"389","2":"390","3":"-1","4":"early"},{"1":"392","2":"368","3":"24","4":"late"},{"1":"395","2":"395","3":"0","4":"early"},{"1":"397","2":"405","3":"-8","4":"early"},{"1":"399","2":"400","3":"-1","4":"early"},{"1":"403","2":"406","3":"-3","4":"early"},{"1":"403","2":"405","3":"-2","4":"early"},{"1":"404","2":"396","3":"8","4":"late"},{"1":"405","2":"407","3":"-2","4":"early"},{"1":"406","2":"405","3":"1","4":"late"},{"1":"406","2":"405","3":"1","4":"late"},{"1":"411","2":"415","3":"-4","4":"early"},{"1":"412","2":"415","3":"-3","4":"early"},{"1":"413","2":"420","3":"-7","4":"early"},{"1":"415","2":"415","3":"0","4":"early"},{"1":"415","2":"420","3":"-5","4":"early"},{"1":"415","2":"420","3":"-5","4":"early"},{"1":"416","2":"420","3":"-4","4":"early"},{"1":"416","2":"419","3":"-3","4":"early"},{"1":"416","2":"425","3":"-9","4":"early"},{"1":"416","2":"420","3":"-4","4":"early"},{"1":"417","2":"420","3":"-3","4":"early"},{"1":"418","2":"420","3":"-2","4":"early"},{"1":"418","2":"420","3":"-2","4":"early"},{"1":"419","2":"420","3":"-1","4":"early"},{"1":"419","2":"420","3":"-1","4":"early"},{"1":"419","2":"425","3":"-6","4":"early"},{"1":"419","2":"420","3":"-1","4":"early"},{"1":"421","2":"420","3":"1","4":"late"},{"1":"422","2":"420","3":"2","4":"late"},{"1":"429","2":"420","3":"9","4":"late"},{"1":"431","2":"435","3":"-4","4":"early"},{"1":"432","2":"435","3":"-3","4":"early"},{"1":"435","2":"433","3":"2","4":"late"},{"1":"437","2":"440","3":"-3","4":"early"},{"1":"439","2":"441","3":"-2","4":"early"},{"1":"443","2":"445","3":"-2","4":"early"},{"1":"444","2":"450","3":"-6","4":"early"},{"1":"444","2":"445","3":"-1","4":"early"},{"1":"445","2":"450","3":"-5","4":"early"},{"1":"447","2":"450","3":"-3","4":"early"},{"1":"448","2":"452","3":"-4","4":"early"},{"1":"449","2":"450","3":"-1","4":"early"},{"1":"452","2":"455","3":"-3","4":"early"},{"1":"452","2":"449","3":"3","4":"late"},{"1":"452","2":"405","3":"47","4":"late"},{"1":"453","2":"456","3":"-3","4":"early"},{"1":"454","2":"457","3":"-3","4":"early"},{"1":"459","2":"465","3":"-6","4":"early"},{"1":"459","2":"459","3":"0","4":"early"},{"1":"461","2":"465","3":"-4","4":"early"},{"1":"463","2":"450","3":"13","4":"late"},{"1":"463","2":"469","3":"-6","4":"early"},{"1":"463","2":"450","3":"13","4":"late"},{"1":"465","2":"465","3":"0","4":"early"},{"1":"466","2":"466","3":"0","4":"early"},{"1":"469","2":"430","3":"39","4":"late"},{"1":"472","2":"475","3":"-3","4":"early"},{"1":"472","2":"470","3":"2","4":"late"},{"1":"472","2":"479","3":"-7","4":"early"},{"1":"473","2":"475","3":"-2","4":"early"},{"1":"474","2":"479","3":"-5","4":"early"},{"1":"474","2":"475","3":"-1","4":"early"},{"1":"478","2":"480","3":"-2","4":"early"},{"1":"479","2":"480","3":"-1","4":"early"},{"1":"480","2":"480","3":"0","4":"early"},{"1":"480","2":"490","3":"-10","4":"early"},{"1":"481","2":"485","3":"-4","4":"early"},{"1":"483","2":"490","3":"-7","4":"early"},{"1":"483","2":"480","3":"3","4":"late"},{"1":"484","2":"490","3":"-6","4":"early"},{"1":"485","2":"485","3":"0","4":"early"},{"1":"485","2":"480","3":"5","4":"late"},{"1":"485","2":"495","3":"-10","4":"early"},{"1":"487","2":"490","3":"-3","4":"early"},{"1":"489","2":"495","3":"-6","4":"early"},{"1":"490","2":"490","3":"0","4":"early"},{"1":"490","2":"495","3":"-5","4":"early"},{"1":"491","2":"495","3":"-4","4":"early"},{"1":"491","2":"390","3":"101","4":"really late"},{"1":"491","2":"495","3":"-4","4":"early"},{"1":"492","2":"494","3":"-2","4":"early"},{"1":"493","2":"495","3":"-2","4":"early"},{"1":"494","2":"490","3":"4","4":"late"},{"1":"497","2":"490","3":"7","4":"late"},{"1":"500","2":"500","3":"0","4":"early"},{"1":"500","2":"510","3":"-10","4":"early"},{"1":"500","2":"500","3":"0","4":"early"},{"1":"501","2":"500","3":"1","4":"late"},{"1":"501","2":"505","3":"-4","4":"early"},{"1":"502","2":"510","3":"-8","4":"early"},{"1":"503","2":"505","3":"-2","4":"early"},{"1":"503","2":"503","3":"0","4":"early"},{"1":"504","2":"510","3":"-6","4":"early"},{"1":"505","2":"507","3":"-2","4":"early"},{"1":"506","2":"435","3":"71","4":"really late"},{"1":"506","2":"497","3":"9","4":"late"},{"1":"508","2":"510","3":"-2","4":"early"},{"1":"508","2":"503","3":"5","4":"late"},{"1":"509","2":"510","3":"-1","4":"early"},{"1":"509","2":"510","3":"-1","4":"early"},{"1":"510","2":"510","3":"0","4":"early"},{"1":"510","2":"515","3":"-5","4":"early"},{"1":"511","2":"515","3":"-4","4":"early"},{"1":"512","2":"520","3":"-8","4":"early"},{"1":"513","2":"515","3":"-2","4":"early"},{"1":"515","2":"515","3":"0","4":"early"},{"1":"519","2":"530","3":"-11","4":"early"},{"1":"520","2":"525","3":"-5","4":"early"},{"1":"520","2":"525","3":"-5","4":"early"},{"1":"526","2":"525","3":"1","4":"late"},{"1":"1968","2":"1115","3":"853","4":"really late"},{"1":"528","2":"531","3":"-3","4":"early"},{"1":"531","2":"531","3":"0","4":"early"},{"1":"531","2":"539","3":"-8","4":"early"},{"1":"531","2":"520","3":"11","4":"late"},{"1":"532","2":"535","3":"-3","4":"early"},{"1":"533","2":"525","3":"8","4":"late"},{"1":"535","2":"539","3":"-4","4":"early"},{"1":"536","2":"540","3":"-4","4":"early"},{"1":"536","2":"540","3":"-4","4":"early"},{"1":"536","2":"535","3":"1","4":"late"},{"1":"537","2":"540","3":"-3","4":"early"},{"1":"537","2":"545","3":"-8","4":"early"},{"1":"537","2":"540","3":"-3","4":"early"},{"1":"537","2":"531","3":"6","4":"late"},{"1":"538","2":"540","3":"-2","4":"early"},{"1":"539","2":"540","3":"-1","4":"early"},{"1":"539","2":"540","3":"-1","4":"early"},{"1":"540","2":"540","3":"0","4":"early"},{"1":"542","2":"543","3":"-1","4":"early"},{"1":"543","2":"500","3":"43","4":"late"},{"1":"544","2":"546","3":"-2","4":"early"},{"1":"545","2":"545","3":"0","4":"early"},{"1":"546","2":"523","3":"23","4":"late"},{"1":"548","2":"550","3":"-2","4":"early"},{"1":"548","2":"555","3":"-7","4":"early"},{"1":"548","2":"548","3":"0","4":"early"},{"1":"549","2":"490","3":"59","4":"really late"},{"1":"552","2":"540","3":"12","4":"late"},{"1":"552","2":"546","3":"6","4":"late"},{"1":"553","2":"558","3":"-5","4":"early"},{"1":"554","2":"560","3":"-6","4":"early"},{"1":"554","2":"540","3":"14","4":"late"},{"1":"557","2":"560","3":"-3","4":"early"},{"1":"557","2":"555","3":"2","4":"late"},{"1":"557","2":"560","3":"-3","4":"early"},{"1":"560","2":"545","3":"15","4":"late"},{"1":"560","2":"560","3":"0","4":"early"},{"1":"561","2":"540","3":"21","4":"late"},{"1":"563","2":"559","3":"4","4":"late"},{"1":"566","2":"569","3":"-3","4":"early"},{"1":"566","2":"562","3":"4","4":"late"},{"1":"566","2":"568","3":"-2","4":"early"},{"1":"567","2":"570","3":"-3","4":"early"},{"1":"569","2":"569","3":"0","4":"early"},{"1":"569","2":"565","3":"4","4":"late"},{"1":"570","2":"545","3":"25","4":"late"},{"1":"571","2":"570","3":"1","4":"late"},{"1":"571","2":"570","3":"1","4":"late"},{"1":"572","2":"570","3":"2","4":"late"},{"1":"573","2":"577","3":"-4","4":"early"},{"1":"573","2":"544","3":"29","4":"late"},{"1":"573","2":"575","3":"-2","4":"early"},{"1":"576","2":"580","3":"-4","4":"early"},{"1":"576","2":"585","3":"-9","4":"early"},{"1":"577","2":"580","3":"-3","4":"early"},{"1":"577","2":"580","3":"-3","4":"early"},{"1":"580","2":"585","3":"-5","4":"early"},{"1":"580","2":"595","3":"-15","4":"early"},{"1":"581","2":"585","3":"-4","4":"early"},{"1":"586","2":"599","3":"-13","4":"early"},{"1":"587","2":"593","3":"-6","4":"early"},{"1":"590","2":"594","3":"-4","4":"early"},{"1":"593","2":"599","3":"-6","4":"early"},{"1":"593","2":"561","3":"32","4":"late"},{"1":"595","2":"600","3":"-5","4":"early"},{"1":"596","2":"600","3":"-4","4":"early"},{"1":"597","2":"453","3":"144","4":"really late"},{"1":"599","2":"602","3":"-3","4":"early"},{"1":"599","2":"600","3":"-1","4":"early"},{"1":"603","2":"610","3":"-7","4":"early"},{"1":"603","2":"599","3":"4","4":"late"},{"1":"605","2":"600","3":"5","4":"late"},{"1":"607","2":"610","3":"-3","4":"early"},{"1":"609","2":"615","3":"-6","4":"early"},{"1":"610","2":"615","3":"-5","4":"early"},{"1":"610","2":"615","3":"-5","4":"early"},{"1":"611","2":"601","3":"10","4":"late"},{"1":"611","2":"615","3":"-4","4":"early"},{"1":"621","2":"623","3":"-2","4":"early"},{"1":"624","2":"629","3":"-5","4":"early"},{"1":"624","2":"630","3":"-6","4":"early"},{"1":"625","2":"620","3":"5","4":"late"},{"1":"625","2":"591","3":"34","4":"late"},{"1":"626","2":"630","3":"-4","4":"early"},{"1":"628","2":"626","3":"2","4":"late"},{"1":"629","2":"630","3":"-1","4":"early"},{"1":"630","2":"635","3":"-5","4":"early"},{"1":"631","2":"630","3":"1","4":"late"},{"1":"631","2":"630","3":"1","4":"late"},{"1":"632","2":"635","3":"-3","4":"early"},{"1":"633","2":"617","3":"16","4":"late"},{"1":"637","2":"630","3":"7","4":"late"},{"1":"638","2":"630","3":"8","4":"late"},{"1":"642","2":"640","3":"2","4":"late"},{"1":"644","2":"645","3":"-1","4":"early"},{"1":"644","2":"645","3":"-1","4":"early"},{"1":"644","2":"641","3":"3","4":"late"},{"1":"647","2":"655","3":"-8","4":"early"},{"1":"647","2":"650","3":"-3","4":"early"},{"1":"648","2":"650","3":"-2","4":"early"},{"1":"653","2":"650","3":"3","4":"late"},{"1":"654","2":"659","3":"-5","4":"early"},{"1":"656","2":"659","3":"-3","4":"early"},{"1":"656","2":"660","3":"-4","4":"early"},{"1":"658","2":"660","3":"-2","4":"early"},{"1":"659","2":"660","3":"-1","4":"early"},{"1":"659","2":"660","3":"-1","4":"early"},{"1":"659","2":"653","3":"6","4":"late"},{"1":"661","2":"643","3":"18","4":"late"},{"1":"663","2":"660","3":"3","4":"late"},{"1":"665","2":"647","3":"18","4":"late"},{"1":"667","2":"675","3":"-8","4":"early"},{"1":"669","2":"675","3":"-6","4":"early"},{"1":"671","2":"675","3":"-4","4":"early"},{"1":"672","2":"660","3":"12","4":"late"},{"1":"673","2":"675","3":"-2","4":"early"},{"1":"674","2":"540","3":"134","4":"really late"},{"1":"680","2":"584","3":"96","4":"really late"},{"1":"680","2":"685","3":"-5","4":"early"},{"1":"683","2":"670","3":"13","4":"late"},{"1":"684","2":"660","3":"24","4":"late"},{"1":"684","2":"685","3":"-1","4":"early"},{"1":"685","2":"690","3":"-5","4":"early"},{"1":"687","2":"689","3":"-2","4":"early"},{"1":"687","2":"690","3":"-3","4":"early"},{"1":"687","2":"689","3":"-2","4":"early"},{"1":"688","2":"689","3":"-1","4":"early"},{"1":"690","2":"685","3":"5","4":"late"},{"1":"690","2":"691","3":"-1","4":"early"},{"1":"692","2":"695","3":"-3","4":"early"},{"1":"693","2":"689","3":"4","4":"late"},{"1":"693","2":"690","3":"3","4":"late"},{"1":"695","2":"700","3":"-5","4":"early"},{"1":"697","2":"700","3":"-3","4":"early"},{"1":"703","2":"705","3":"-2","4":"early"},{"1":"704","2":"705","3":"-1","4":"early"},{"1":"707","2":"715","3":"-8","4":"early"},{"1":"710","2":"716","3":"-6","4":"early"},{"1":"713","2":"719","3":"-6","4":"early"},{"1":"713","2":"683","3":"30","4":"late"},{"1":"713","2":"720","3":"-7","4":"early"},{"1":"714","2":"720","3":"-6","4":"early"},{"1":"714","2":"720","3":"-6","4":"early"},{"1":"715","2":"720","3":"-5","4":"early"},{"1":"715","2":"720","3":"-5","4":"early"},{"1":"715","2":"720","3":"-5","4":"early"},{"1":"715","2":"720","3":"-5","4":"early"},{"1":"717","2":"718","3":"-1","4":"early"},{"1":"717","2":"725","3":"-8","4":"early"},{"1":"717","2":"720","3":"-3","4":"early"},{"1":"718","2":"725","3":"-7","4":"early"},{"1":"718","2":"720","3":"-2","4":"early"},{"1":"718","2":"720","3":"-2","4":"early"},{"1":"720","2":"720","3":"0","4":"early"},{"1":"722","2":"727","3":"-5","4":"early"},{"1":"722","2":"719","3":"3","4":"late"},{"1":"723","2":"725","3":"-2","4":"early"},{"1":"723","2":"720","3":"3","4":"late"},{"1":"724","2":"720","3":"4","4":"late"},{"1":"725","2":"720","3":"5","4":"late"},{"1":"726","2":"729","3":"-3","4":"early"},{"1":"728","2":"718","3":"10","4":"late"},{"1":"731","2":"735","3":"-4","4":"early"},{"1":"737","2":"740","3":"-3","4":"early"},{"1":"737","2":"738","3":"-1","4":"early"},{"1":"739","2":"740","3":"-1","4":"early"},{"1":"739","2":"745","3":"-6","4":"early"},{"1":"740","2":"740","3":"0","4":"early"},{"1":"742","2":"719","3":"23","4":"late"},{"1":"742","2":"749","3":"-7","4":"early"},{"1":"748","2":"744","3":"4","4":"late"},{"1":"750","2":"755","3":"-5","4":"early"},{"1":"751","2":"758","3":"-7","4":"early"},{"1":"751","2":"749","3":"2","4":"late"},{"1":"757","2":"765","3":"-8","4":"early"},{"1":"758","2":"760","3":"-2","4":"early"},{"1":"760","2":"749","3":"11","4":"late"},{"1":"760","2":"765","3":"-5","4":"early"},{"1":"760","2":"755","3":"5","4":"late"},{"1":"761","2":"767","3":"-6","4":"early"},{"1":"765","2":"765","3":"0","4":"early"},{"1":"765","2":"769","3":"-4","4":"early"},{"1":"766","2":"745","3":"21","4":"late"},{"1":"768","2":"770","3":"-2","4":"early"},{"1":"771","2":"772","3":"-1","4":"early"},{"1":"772","2":"765","3":"7","4":"late"},{"1":"773","2":"732","3":"41","4":"late"},{"1":"775","2":"780","3":"-5","4":"early"},{"1":"775","2":"775","3":"0","4":"early"},{"1":"775","2":"720","3":"55","4":"really late"},{"1":"775","2":"779","3":"-4","4":"early"},{"1":"775","2":"780","3":"-5","4":"early"},{"1":"777","2":"778","3":"-1","4":"early"},{"1":"777","2":"780","3":"-3","4":"early"},{"1":"778","2":"788","3":"-10","4":"early"},{"1":"778","2":"780","3":"-2","4":"early"},{"1":"781","2":"760","3":"21","4":"late"},{"1":"781","2":"710","3":"71","4":"really late"},{"1":"781","2":"775","3":"6","4":"late"},{"1":"782","2":"779","3":"3","4":"late"},{"1":"782","2":"780","3":"2","4":"late"},{"1":"784","2":"747","3":"37","4":"late"},{"1":"784","2":"779","3":"5","4":"late"},{"1":"785","2":"795","3":"-10","4":"early"},{"1":"786","2":"760","3":"26","4":"late"},{"1":"786","2":"780","3":"6","4":"late"},{"1":"790","2":"780","3":"10","4":"late"},{"1":"794","2":"795","3":"-1","4":"early"},{"1":"795","2":"797","3":"-2","4":"early"},{"1":"796","2":"794","3":"2","4":"late"},{"1":"797","2":"805","3":"-8","4":"early"},{"1":"798","2":"802","3":"-4","4":"early"},{"1":"800","2":"795","3":"5","4":"late"},{"1":"800","2":"800","3":"0","4":"early"},{"1":"803","2":"780","3":"23","4":"late"},{"1":"805","2":"810","3":"-5","4":"early"},{"1":"807","2":"810","3":"-3","4":"early"},{"1":"807","2":"809","3":"-2","4":"early"},{"1":"810","2":"801","3":"9","4":"late"},{"1":"813","2":"815","3":"-2","4":"early"},{"1":"816","2":"820","3":"-4","4":"early"},{"1":"817","2":"740","3":"77","4":"really late"},{"1":"819","2":"825","3":"-6","4":"early"},{"1":"819","2":"815","3":"4","4":"late"},{"1":"821","2":"825","3":"-4","4":"early"},{"1":"822","2":"800","3":"22","4":"late"},{"1":"823","2":"810","3":"13","4":"late"},{"1":"824","2":"824","3":"0","4":"early"},{"1":"826","2":"810","3":"16","4":"late"},{"1":"830","2":"809","3":"21","4":"late"},{"1":"830","2":"835","3":"-5","4":"early"},{"1":"831","2":"835","3":"-4","4":"early"},{"1":"833","2":"837","3":"-4","4":"early"},{"1":"834","2":"836","3":"-2","4":"early"},{"1":"834","2":"839","3":"-5","4":"early"},{"1":"835","2":"795","3":"40","4":"late"},{"1":"835","2":"836","3":"-1","4":"early"},{"1":"835","2":"830","3":"5","4":"late"},{"1":"836","2":"830","3":"6","4":"late"},{"1":"836","2":"779","3":"57","4":"really late"},{"1":"836","2":"834","3":"2","4":"late"},{"1":"836","2":"830","3":"6","4":"late"},{"1":"838","2":"830","3":"8","4":"late"},{"1":"840","2":"770","3":"70","4":"really late"},{"1":"840","2":"840","3":"0","4":"early"},{"1":"842","2":"803","3":"39","4":"late"},{"1":"848","2":"851","3":"-3","4":"early"},{"1":"851","2":"795","3":"56","4":"really late"},{"1":"856","2":"851","3":"5","4":"late"},{"1":"858","2":"859","3":"-1","4":"early"},{"1":"859","2":"860","3":"-1","4":"early"},{"1":"861","2":"862","3":"-1","4":"early"},{"1":"861","2":"835","3":"26","4":"late"},{"1":"861","2":"870","3":"-9","4":"early"},{"1":"862","2":"850","3":"12","4":"late"},{"1":"862","2":"865","3":"-3","4":"early"},{"1":"863","2":"870","3":"-7","4":"early"},{"1":"864","2":"829","3":"35","4":"late"},{"1":"864","2":"860","3":"4","4":"late"},{"1":"868","2":"809","3":"59","4":"really late"},{"1":"870","2":"839","3":"31","4":"late"},{"1":"870","2":"870","3":"0","4":"early"},{"1":"871","2":"869","3":"2","4":"late"},{"1":"871","2":"880","3":"-9","4":"early"},{"1":"873","2":"875","3":"-2","4":"early"},{"1":"876","2":"875","3":"1","4":"late"},{"1":"879","2":"885","3":"-6","4":"early"},{"1":"880","2":"880","3":"0","4":"early"},{"1":"882","2":"890","3":"-8","4":"early"},{"1":"883","2":"884","3":"-1","4":"early"},{"1":"885","2":"895","3":"-10","4":"early"},{"1":"885","2":"885","3":"0","4":"early"},{"1":"886","2":"895","3":"-9","4":"early"},{"1":"888","2":"885","3":"3","4":"late"},{"1":"889","2":"890","3":"-1","4":"early"},{"1":"891","2":"900","3":"-9","4":"early"},{"1":"892","2":"895","3":"-3","4":"early"},{"1":"892","2":"897","3":"-5","4":"early"},{"1":"893","2":"890","3":"3","4":"late"},{"1":"893","2":"900","3":"-7","4":"early"},{"1":"894","2":"898","3":"-4","4":"early"},{"1":"894","2":"900","3":"-6","4":"early"},{"1":"894","2":"900","3":"-6","4":"early"},{"1":"895","2":"897","3":"-2","4":"early"},{"1":"895","2":"899","3":"-4","4":"early"},{"1":"895","2":"900","3":"-5","4":"early"},{"1":"896","2":"900","3":"-4","4":"early"},{"1":"896","2":"895","3":"1","4":"late"},{"1":"897","2":"900","3":"-3","4":"early"},{"1":"897","2":"900","3":"-3","4":"early"},{"1":"898","2":"900","3":"-2","4":"early"},{"1":"899","2":"901","3":"-2","4":"early"},{"1":"899","2":"894","3":"5","4":"late"},{"1":"900","2":"899","3":"1","4":"late"},{"1":"902","2":"900","3":"2","4":"late"},{"1":"905","2":"790","3":"115","4":"really late"},{"1":"905","2":"910","3":"-5","4":"early"},{"1":"906","2":"905","3":"1","4":"late"},{"1":"906","2":"912","3":"-6","4":"early"},{"1":"907","2":"915","3":"-8","4":"early"},{"1":"907","2":"910","3":"-3","4":"early"},{"1":"908","2":"890","3":"18","4":"late"},{"1":"910","2":"917","3":"-7","4":"early"},{"1":"911","2":"900","3":"11","4":"late"},{"1":"911","2":"915","3":"-4","4":"early"},{"1":"912","2":"918","3":"-6","4":"early"},{"1":"913","2":"905","3":"8","4":"late"},{"1":"913","2":"915","3":"-2","4":"early"},{"1":"915","2":"877","3":"38","4":"late"},{"1":"918","2":"916","3":"2","4":"late"},{"1":"920","2":"870","3":"50","4":"late"},{"1":"920","2":"925","3":"-5","4":"early"},{"1":"920","2":"920","3":"0","4":"early"},{"1":"921","2":"915","3":"6","4":"late"},{"1":"922","2":"930","3":"-8","4":"early"},{"1":"922","2":"930","3":"-8","4":"early"},{"1":"923","2":"916","3":"7","4":"late"},{"1":"924","2":"897","3":"27","4":"late"},{"1":"925","2":"820","3":"105","4":"really late"},{"1":"925","2":"930","3":"-5","4":"early"},{"1":"926","2":"930","3":"-4","4":"early"},{"1":"927","2":"930","3":"-3","4":"early"},{"1":"927","2":"895","3":"32","4":"late"},{"1":"927","2":"933","3":"-6","4":"early"},{"1":"927","2":"915","3":"12","4":"late"},{"1":"928","2":"899","3":"29","4":"late"},{"1":"928","2":"930","3":"-2","4":"early"},{"1":"929","2":"897","3":"32","4":"late"},{"1":"929","2":"930","3":"-1","4":"early"},{"1":"930","2":"930","3":"0","4":"early"},{"1":"931","2":"893","3":"38","4":"late"},{"1":"931","2":"899","3":"32","4":"late"},{"1":"931","2":"920","3":"11","4":"late"},{"1":"934","2":"930","3":"4","4":"late"},{"1":"936","2":"920","3":"16","4":"late"},{"1":"938","2":"940","3":"-2","4":"early"},{"1":"939","2":"930","3":"9","4":"late"},{"1":"939","2":"945","3":"-6","4":"early"},{"1":"939","2":"937","3":"2","4":"late"},{"1":"940","2":"818","3":"122","4":"really late"},{"1":"942","2":"945","3":"-3","4":"early"},{"1":"943","2":"950","3":"-7","4":"early"},{"1":"943","2":"943","3":"0","4":"early"},{"1":"946","2":"940","3":"6","4":"late"},{"1":"947","2":"945","3":"2","4":"late"},{"1":"948","2":"860","3":"88","4":"really late"},{"1":"949","2":"885","3":"64","4":"really late"},{"1":"949","2":"948","3":"1","4":"late"},{"1":"950","2":"950","3":"0","4":"early"},{"1":"952","2":"960","3":"-8","4":"early"},{"1":"952","2":"960","3":"-8","4":"early"},{"1":"952","2":"960","3":"-8","4":"early"},{"1":"952","2":"960","3":"-8","4":"early"},{"1":"954","2":"960","3":"-6","4":"early"},{"1":"954","2":"959","3":"-5","4":"early"},{"1":"954","2":"960","3":"-6","4":"early"},{"1":"956","2":"960","3":"-4","4":"early"},{"1":"957","2":"960","3":"-3","4":"early"},{"1":"957","2":"960","3":"-3","4":"early"},{"1":"958","2":"934","3":"24","4":"late"},{"1":"958","2":"839","3":"119","4":"really late"},{"1":"958","2":"960","3":"-2","4":"early"},{"1":"959","2":"965","3":"-6","4":"early"},{"1":"960","2":"970","3":"-10","4":"early"},{"1":"961","2":"961","3":"0","4":"early"},{"1":"962","2":"965","3":"-3","4":"early"},{"1":"963","2":"947","3":"16","4":"late"},{"1":"963","2":"950","3":"13","4":"late"},{"1":"963","2":"960","3":"3","4":"late"},{"1":"963","2":"965","3":"-2","4":"early"},{"1":"963","2":"960","3":"3","4":"late"},{"1":"964","2":"910","3":"54","4":"really late"},{"1":"965","2":"970","3":"-5","4":"early"},{"1":"967","2":"955","3":"12","4":"late"},{"1":"967","2":"883","3":"84","4":"really late"},{"1":"968","2":"935","3":"33","4":"late"},{"1":"968","2":"960","3":"8","4":"late"},{"1":"968","2":"969","3":"-1","4":"early"},{"1":"970","2":"975","3":"-5","4":"early"},{"1":"970","2":"975","3":"-5","4":"early"},{"1":"970","2":"955","3":"15","4":"late"},{"1":"971","2":"961","3":"10","4":"late"},{"1":"975","2":"962","3":"13","4":"late"},{"1":"979","2":"985","3":"-6","4":"early"},{"1":"980","2":"980","3":"0","4":"early"},{"1":"981","2":"948","3":"33","4":"late"},{"1":"983","2":"980","3":"3","4":"late"},{"1":"985","2":"950","3":"35","4":"late"},{"1":"986","2":"990","3":"-4","4":"early"},{"1":"986","2":"990","3":"-4","4":"early"},{"1":"987","2":"899","3":"88","4":"really late"},{"1":"987","2":"990","3":"-3","4":"early"},{"1":"988","2":"924","3":"64","4":"really late"},{"1":"988","2":"990","3":"-2","4":"early"},{"1":"990","2":"948","3":"42","4":"late"},{"1":"990","2":"996","3":"-6","4":"early"},{"1":"991","2":"977","3":"14","4":"late"},{"1":"991","2":"995","3":"-4","4":"early"},{"1":"991","2":"990","3":"1","4":"late"},{"1":"992","2":"995","3":"-3","4":"early"},{"1":"992","2":"995","3":"-3","4":"early"},{"1":"994","2":"986","3":"8","4":"late"},{"1":"995","2":"990","3":"5","4":"late"},{"1":"996","2":"999","3":"-3","4":"early"},{"1":"997","2":"945","3":"52","4":"really late"},{"1":"999","2":"917","3":"82","4":"really late"},{"1":"1000","2":"1000","3":"0","4":"early"},{"1":"1001","2":"1010","3":"-9","4":"early"},{"1":"1002","2":"970","3":"32","4":"late"},{"1":"1005","2":"999","3":"6","4":"late"},{"1":"1009","2":"999","3":"10","4":"late"},{"1":"1010","2":"975","3":"35","4":"late"},{"1":"1011","2":"1010","3":"1","4":"late"},{"1":"1012","2":"1000","3":"12","4":"late"},{"1":"1013","2":"1020","3":"-7","4":"early"},{"1":"1014","2":"1004","3":"10","4":"late"},{"1":"1014","2":"1020","3":"-6","4":"early"},{"1":"1015","2":"981","3":"34","4":"late"},{"1":"1015","2":"1020","3":"-5","4":"early"},{"1":"1015","2":"1020","3":"-5","4":"early"},{"1":"1015","2":"1015","3":"0","4":"early"},{"1":"1016","2":"1020","3":"-4","4":"early"},{"1":"1017","2":"1010","3":"7","4":"late"},{"1":"1017","2":"990","3":"27","4":"late"},{"1":"1018","2":"1020","3":"-2","4":"early"},{"1":"1021","2":"1030","3":"-9","4":"early"},{"1":"1021","2":"1020","3":"1","4":"late"},{"1":"1022","2":"1020","3":"2","4":"late"},{"1":"1025","2":"1025","3":"0","4":"early"},{"1":"1025","2":"1030","3":"-5","4":"early"},{"1":"1027","2":"1025","3":"2","4":"late"},{"1":"1027","2":"1020","3":"7","4":"late"},{"1":"1028","2":"1020","3":"8","4":"late"},{"1":"1031","2":"1010","3":"21","4":"late"},{"1":"1031","2":"995","3":"36","4":"late"},{"1":"1031","2":"960","3":"71","4":"really late"},{"1":"1032","2":"1039","3":"-7","4":"early"},{"1":"1032","2":"1020","3":"12","4":"late"},{"1":"1033","2":"1020","3":"13","4":"late"},{"1":"1034","2":"1040","3":"-6","4":"early"},{"1":"1036","2":"1050","3":"-14","4":"early"},{"1":"1036","2":"945","3":"91","4":"really late"},{"1":"1036","2":"1029","3":"7","4":"late"},{"1":"1037","2":"1040","3":"-3","4":"early"},{"1":"1038","2":"1030","3":"8","4":"late"},{"1":"1039","2":"1040","3":"-1","4":"early"},{"1":"1040","2":"1045","3":"-5","4":"early"},{"1":"1045","2":"1050","3":"-5","4":"early"},{"1":"1045","2":"1040","3":"5","4":"late"},{"1":"1046","2":"1050","3":"-4","4":"early"},{"1":"1046","2":"1049","3":"-3","4":"early"},{"1":"1047","2":"1045","3":"2","4":"late"},{"1":"1048","2":"960","3":"88","4":"really late"},{"1":"1049","2":"1038","3":"11","4":"late"},{"1":"1050","2":"1050","3":"0","4":"early"},{"1":"1050","2":"1050","3":"0","4":"early"},{"1":"1050","2":"1049","3":"1","4":"late"},{"1":"1052","2":"990","3":"62","4":"really late"},{"1":"1056","2":"1000","3":"56","4":"really late"},{"1":"1058","2":"1065","3":"-7","4":"early"},{"1":"1059","2":"1065","3":"-6","4":"early"},{"1":"1059","2":"1060","3":"-1","4":"early"},{"1":"1060","2":"990","3":"70","4":"really late"},{"1":"1060","2":"1065","3":"-5","4":"early"},{"1":"1062","2":"1066","3":"-4","4":"early"},{"1":"1063","2":"975","3":"88","4":"really late"},{"1":"1064","2":"1070","3":"-6","4":"early"},{"1":"1064","2":"1040","3":"24","4":"late"},{"1":"1064","2":"1065","3":"-1","4":"early"},{"1":"1064","2":"1065","3":"-1","4":"early"},{"1":"1065","2":"1069","3":"-4","4":"early"},{"1":"1070","2":"1070","3":"0","4":"early"},{"1":"1071","2":"1065","3":"6","4":"late"},{"1":"1071","2":"1065","3":"6","4":"late"},{"1":"1073","2":"1065","3":"8","4":"late"},{"1":"1076","2":"1045","3":"31","4":"late"},{"1":"1077","2":"1023","3":"54","4":"really late"},{"1":"1077","2":"1079","3":"-2","4":"early"},{"1":"1078","2":"1080","3":"-2","4":"early"},{"1":"1078","2":"1080","3":"-2","4":"early"},{"1":"1078","2":"1069","3":"9","4":"late"},{"1":"1079","2":"1079","3":"0","4":"early"},{"1":"1080","2":"1080","3":"0","4":"early"},{"1":"1080","2":"1080","3":"0","4":"early"},{"1":"1082","2":"1085","3":"-3","4":"early"},{"1":"1082","2":"1081","3":"1","4":"late"},{"1":"1083","2":"1046","3":"37","4":"late"},{"1":"1083","2":"980","3":"103","4":"really late"},{"1":"1083","2":"1080","3":"3","4":"late"},{"1":"1085","2":"1077","3":"8","4":"late"},{"1":"1086","2":"1090","3":"-4","4":"early"},{"1":"1087","2":"1058","3":"29","4":"late"},{"1":"1088","2":"1095","3":"-7","4":"early"},{"1":"1089","2":"1090","3":"-1","4":"early"},{"1":"1091","2":"1079","3":"12","4":"late"},{"1":"1094","2":"1020","3":"74","4":"really late"},{"1":"1094","2":"1095","3":"-1","4":"early"},{"1":"1095","2":"805","3":"290","4":"really late"},{"1":"1095","2":"1085","3":"10","4":"late"},{"1":"1096","2":"1085","3":"11","4":"late"},{"1":"1096","2":"1080","3":"16","4":"late"},{"1":"1097","2":"1100","3":"-3","4":"early"},{"1":"1100","2":"1100","3":"0","4":"early"},{"1":"1103","2":"1110","3":"-7","4":"early"},{"1":"1104","2":"1110","3":"-6","4":"early"},{"1":"1105","2":"1109","3":"-4","4":"early"},{"1":"1105","2":"1109","3":"-4","4":"early"},{"1":"1106","2":"1090","3":"16","4":"late"},{"1":"1106","2":"1110","3":"-4","4":"early"},{"1":"1107","2":"1109","3":"-2","4":"early"},{"1":"1108","2":"1085","3":"23","4":"late"},{"1":"1110","2":"1109","3":"1","4":"late"},{"1":"1112","2":"1103","3":"9","4":"late"},{"1":"1112","2":"1115","3":"-3","4":"early"},{"1":"1112","2":"1108","3":"4","4":"late"},{"1":"1114","2":"1120","3":"-6","4":"early"},{"1":"1114","2":"1080","3":"34","4":"late"},{"1":"1116","2":"1046","3":"70","4":"really late"},{"1":"1120","2":"1116","3":"4","4":"late"},{"1":"1120","2":"1125","3":"-5","4":"early"},{"1":"1120","2":"1125","3":"-5","4":"early"},{"1":"1122","2":"862","3":"260","4":"really late"},{"1":"1122","2":"1109","3":"13","4":"late"},{"1":"1123","2":"1130","3":"-7","4":"early"},{"1":"1123","2":"1125","3":"-2","4":"early"},{"1":"1123","2":"1115","3":"8","4":"late"},{"1":"1126","2":"1065","3":"61","4":"really late"},{"1":"1126","2":"1135","3":"-9","4":"early"},{"1":"1128","2":"1065","3":"63","4":"really late"},{"1":"1129","2":"1140","3":"-11","4":"early"},{"1":"1130","2":"1140","3":"-10","4":"early"},{"1":"1130","2":"1130","3":"0","4":"early"},{"1":"1130","2":"1130","3":"0","4":"early"},{"1":"1133","2":"1140","3":"-7","4":"early"},{"1":"1134","2":"1110","3":"24","4":"late"},{"1":"1135","2":"1139","3":"-4","4":"early"},{"1":"1135","2":"1128","3":"7","4":"late"},{"1":"1136","2":"1005","3":"131","4":"really late"},{"1":"1136","2":"1139","3":"-3","4":"early"},{"1":"1136","2":"1135","3":"1","4":"late"},{"1":"1138","2":"1140","3":"-2","4":"early"},{"1":"1139","2":"1140","3":"-1","4":"early"},{"1":"1139","2":"1140","3":"-1","4":"early"},{"1":"1140","2":"1125","3":"15","4":"late"},{"1":"1144","2":"1145","3":"-1","4":"early"},{"1":"1144","2":"1145","3":"-1","4":"early"},{"1":"1145","2":"1140","3":"5","4":"late"},{"1":"1146","2":"1155","3":"-9","4":"early"},{"1":"1149","2":"1152","3":"-3","4":"early"},{"1":"1149","2":"1150","3":"-1","4":"early"},{"1":"1150","2":"1149","3":"1","4":"late"},{"1":"1150","2":"1150","3":"0","4":"early"},{"1":"1150","2":"1135","3":"15","4":"late"},{"1":"1151","2":"1150","3":"1","4":"late"},{"1":"1152","2":"1155","3":"-3","4":"early"},{"1":"1152","2":"1148","3":"4","4":"late"},{"1":"1155","2":"1160","3":"-5","4":"early"},{"1":"1155","2":"1144","3":"11","4":"late"},{"1":"1156","2":"1160","3":"-4","4":"early"},{"1":"1159","2":"1140","3":"19","4":"late"},{"1":"1161","2":"1160","3":"1","4":"late"},{"1":"1163","2":"1117","3":"46","4":"late"},{"1":"1163","2":"1139","3":"24","4":"late"},{"1":"1165","2":"1170","3":"-5","4":"early"},{"1":"1165","2":"1140","3":"25","4":"late"},{"1":"1166","2":"1150","3":"16","4":"late"},{"1":"1168","2":"1170","3":"-2","4":"early"},{"1":"1169","2":"1160","3":"9","4":"late"},{"1":"1170","2":"1065","3":"105","4":"really late"},{"1":"1174","2":"1045","3":"129","4":"really late"},{"1":"1175","2":"1170","3":"5","4":"late"},{"1":"1177","2":"1145","3":"32","4":"late"},{"1":"1178","2":"1023","3":"155","4":"really late"},{"1":"1179","2":"1120","3":"59","4":"really late"},{"1":"1179","2":"1180","3":"-1","4":"early"},{"1":"1180","2":"1145","3":"35","4":"late"},{"1":"1181","2":"1180","3":"1","4":"late"},{"1":"1182","2":"1025","3":"157","4":"really late"},{"1":"1185","2":"1180","3":"5","4":"late"},{"1":"1186","2":"1170","3":"16","4":"late"},{"1":"1189","2":"1139","3":"50","4":"late"},{"1":"1192","2":"1170","3":"22","4":"late"},{"1":"1192","2":"1200","3":"-8","4":"early"},{"1":"1192","2":"1170","3":"22","4":"late"},{"1":"1195","2":"1200","3":"-5","4":"early"},{"1":"1197","2":"1205","3":"-8","4":"early"},{"1":"1197","2":"1185","3":"12","4":"late"},{"1":"1197","2":"1200","3":"-3","4":"early"},{"1":"1199","2":"1170","3":"29","4":"late"},{"1":"1199","2":"1200","3":"-1","4":"early"},{"1":"1200","2":"1170","3":"30","4":"late"},{"1":"1200","2":"1200","3":"0","4":"early"},{"1":"1202","2":"1195","3":"7","4":"late"},{"1":"1203","2":"1200","3":"3","4":"late"},{"1":"1206","2":"990","3":"216","4":"really late"},{"1":"1206","2":"1200","3":"6","4":"late"},{"1":"1208","2":"1135","3":"73","4":"really late"},{"1":"1208","2":"1215","3":"-7","4":"early"},{"1":"1209","2":"1088","3":"121","4":"really late"},{"1":"1212","2":"1216","3":"-4","4":"early"},{"1":"1213","2":"1215","3":"-2","4":"early"},{"1":"1215","2":"1205","3":"10","4":"late"},{"1":"1216","2":"1170","3":"46","4":"late"},{"1":"1216","2":"1180","3":"36","4":"late"},{"1":"1217","2":"1175","3":"42","4":"late"},{"1":"1217","2":"1215","3":"2","4":"late"},{"1":"1218","2":"1220","3":"-2","4":"early"},{"1":"1220","2":"1230","3":"-10","4":"early"},{"1":"1221","2":"1225","3":"-4","4":"early"},{"1":"1223","2":"1185","3":"38","4":"late"},{"1":"1224","2":"1115","3":"109","4":"really late"},{"1":"1225","2":"1230","3":"-5","4":"early"},{"1":"1225","2":"1228","3":"-3","4":"early"},{"1":"1226","2":"1204","3":"22","4":"late"},{"1":"1226","2":"1170","3":"56","4":"really late"},{"1":"1226","2":"1195","3":"31","4":"late"},{"1":"1230","2":"1230","3":"0","4":"early"},{"1":"1230","2":"1245","3":"-15","4":"early"},{"1":"1230","2":"1235","3":"-5","4":"early"},{"1":"1230","2":"1230","3":"0","4":"early"},{"1":"1231","2":"1230","3":"1","4":"late"},{"1":"1233","2":"1234","3":"-1","4":"early"},{"1":"1235","2":"1230","3":"5","4":"late"},{"1":"1237","2":"1210","3":"27","4":"late"},{"1":"1240","2":"1240","3":"0","4":"early"},{"1":"1246","2":"1235","3":"11","4":"late"},{"1":"1246","2":"1250","3":"-4","4":"early"},{"1":"1250","2":"1199","3":"51","4":"really late"},{"1":"1252","2":"1229","3":"23","4":"late"},{"1":"1252","2":"1245","3":"7","4":"late"},{"1":"1253","2":"1255","3":"-2","4":"early"},{"1":"1255","2":"1260","3":"-5","4":"early"},{"1":"1256","2":"1204","3":"52","4":"really late"},{"1":"1256","2":"1184","3":"72","4":"really late"},{"1":"1256","2":"1260","3":"-4","4":"early"},{"1":"1256","2":"1260","3":"-4","4":"early"},{"1":"1257","2":"1260","3":"-3","4":"early"},{"1":"1258","2":"1260","3":"-2","4":"early"},{"1":"1258","2":"1260","3":"-2","4":"early"},{"1":"1258","2":"1260","3":"-2","4":"early"},{"1":"1260","2":"1260","3":"0","4":"early"},{"1":"1261","2":"1250","3":"11","4":"late"},{"1":"1262","2":"1268","3":"-6","4":"early"},{"1":"1263","2":"1270","3":"-7","4":"early"},{"1":"1267","2":"1240","3":"27","4":"late"},{"1":"1268","2":"1257","3":"11","4":"late"},{"1":"1269","2":"1275","3":"-6","4":"early"},{"1":"1270","2":"1220","3":"50","4":"late"},{"1":"1275","2":"1270","3":"5","4":"late"},{"1":"1275","2":"1020","3":"255","4":"really late"},{"1":"1276","2":"1270","3":"6","4":"late"},{"1":"1279","2":"1170","3":"109","4":"really late"},{"1":"1280","2":"1290","3":"-10","4":"early"},{"1":"1281","2":"1240","3":"41","4":"late"},{"1":"1282","2":"1285","3":"-3","4":"early"},{"1":"1288","2":"1295","3":"-7","4":"early"},{"1":"1288","2":"1285","3":"3","4":"late"},{"1":"1289","2":"1280","3":"9","4":"late"},{"1":"1294","2":"1245","3":"49","4":"late"},{"1":"1296","2":"1305","3":"-9","4":"early"},{"1":"1300","2":"1295","3":"5","4":"late"},{"1":"1317","2":"1315","3":"2","4":"late"},{"1":"1318","2":"1320","3":"-2","4":"early"},{"1":"1325","2":"1040","3":"285","4":"really late"},{"1":"1329","2":"1305","3":"24","4":"late"},{"1":"1329","2":"1315","3":"14","4":"late"},{"1":"1331","2":"1305","3":"26","4":"late"},{"1":"1337","2":"1349","3":"-12","4":"early"},{"1":"1337","2":"1290","3":"47","4":"late"},{"1":"1341","2":"1200","3":"141","4":"really late"},{"1":"1344","2":"1320","3":"24","4":"late"},{"1":"1349","2":"1319","3":"30","4":"late"},{"1":"1360","2":"1365","3":"-5","4":"early"},{"1":"1370","2":"1375","3":"-5","4":"early"},{"1":"1382","2":"1320","3":"62","4":"really late"},{"1":"1386","2":"1365","3":"21","4":"late"},{"1":"1387","2":"1365","3":"22","4":"late"},{"1":"1390","2":"1375","3":"15","4":"late"},{"1":"1392","2":"1200","3":"192","4":"really late"},{"1":"1403","2":"1320","3":"83","4":"really late"},{"1":"1406","2":"1290","3":"116","4":"really late"},{"1":"1407","2":"1370","3":"37","4":"late"},{"1":"1423","2":"1044","3":"379","4":"really late"},{"1":"1433","2":"1439","3":"-6","4":"early"},{"1":"1433","2":"1439","3":"-6","4":"early"},{"1":"1436","2":"1439","3":"-3","4":"early"},{"1":"1482","2":"1439","3":"43","4":"late"},{"1":"1526","2":"1370","3":"156","4":"really late"},{"1":"298","2":"300","3":"-2","4":"early"},{"1":"312","2":"315","3":"-3","4":"early"},{"1":"335","2":"340","3":"-5","4":"early"},{"1":"336","2":"329","3":"7","4":"late"},{"1":"339","2":"345","3":"-6","4":"early"},{"1":"354","2":"360","3":"-6","4":"early"},{"1":"354","2":"360","3":"-6","4":"early"},{"1":"354","2":"360","3":"-6","4":"early"},{"1":"355","2":"360","3":"-5","4":"early"},{"1":"355","2":"360","3":"-5","4":"early"},{"1":"355","2":"360","3":"-5","4":"early"},{"1":"356","2":"360","3":"-4","4":"early"},{"1":"356","2":"360","3":"-4","4":"early"},{"1":"357","2":"365","3":"-8","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"358","2":"360","3":"-2","4":"early"},{"1":"359","2":"361","3":"-2","4":"early"},{"1":"359","2":"360","3":"-1","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"360","2":"365","3":"-5","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"360","2":"365","3":"-5","4":"early"},{"1":"360","2":"360","3":"0","4":"early"},{"1":"362","2":"360","3":"2","4":"late"},{"1":"363","2":"360","3":"3","4":"late"},{"1":"363","2":"359","3":"4","4":"late"},{"1":"365","2":"360","3":"5","4":"late"},{"1":"366","2":"370","3":"-4","4":"early"},{"1":"366","2":"370","3":"-4","4":"early"},{"1":"367","2":"370","3":"-3","4":"early"},{"1":"369","2":"360","3":"9","4":"late"},{"1":"370","2":"360","3":"10","4":"late"},{"1":"370","2":"375","3":"-5","4":"early"},{"1":"371","2":"360","3":"11","4":"late"},{"1":"372","2":"360","3":"12","4":"late"},{"1":"372","2":"375","3":"-3","4":"early"},{"1":"376","2":"360","3":"16","4":"late"},{"1":"377","2":"375","3":"2","4":"late"},{"1":"381","2":"370","3":"11","4":"late"},{"1":"382","2":"390","3":"-8","4":"early"},{"1":"384","2":"360","3":"24","4":"late"},{"1":"385","2":"390","3":"-5","4":"early"},{"1":"385","2":"389","3":"-4","4":"early"},{"1":"385","2":"390","3":"-5","4":"early"},{"1":"386","2":"390","3":"-4","4":"early"},{"1":"388","2":"390","3":"-2","4":"early"},{"1":"388","2":"375","3":"13","4":"late"},{"1":"389","2":"375","3":"14","4":"late"},{"1":"389","2":"380","3":"9","4":"late"},{"1":"389","2":"390","3":"-1","4":"early"},{"1":"390","2":"370","3":"20","4":"late"},{"1":"390","2":"395","3":"-5","4":"early"},{"1":"390","2":"390","3":"0","4":"early"},{"1":"392","2":"395","3":"-3","4":"early"},{"1":"392","2":"390","3":"2","4":"late"},{"1":"394","2":"390","3":"4","4":"late"},{"1":"396","2":"397","3":"-1","4":"early"},{"1":"396","2":"391","3":"5","4":"late"},{"1":"397","2":"400","3":"-3","4":"early"},{"1":"397","2":"390","3":"7","4":"late"},{"1":"397","2":"391","3":"6","4":"late"},{"1":"400","2":"400","3":"0","4":"early"},{"1":"400","2":"406","3":"-6","4":"early"},{"1":"401","2":"395","3":"6","4":"late"},{"1":"401","2":"395","3":"6","4":"late"},{"1":"401","2":"407","3":"-6","4":"early"},{"1":"401","2":"405","3":"-4","4":"early"},{"1":"402","2":"390","3":"12","4":"late"},{"1":"407","2":"405","3":"2","4":"late"},{"1":"407","2":"406","3":"1","4":"late"},{"1":"407","2":"405","3":"2","4":"late"},{"1":"409","2":"415","3":"-6","4":"early"},{"1":"409","2":"411","3":"-2","4":"early"},{"1":"414","2":"420","3":"-6","4":"early"},{"1":"414","2":"411","3":"3","4":"late"},{"1":"415","2":"419","3":"-4","4":"early"},{"1":"415","2":"415","3":"0","4":"early"},{"1":"415","2":"420","3":"-5","4":"early"},{"1":"415","2":"420","3":"-5","4":"early"},{"1":"415","2":"420","3":"-5","4":"early"},{"1":"416","2":"420","3":"-4","4":"early"},{"1":"416","2":"425","3":"-9","4":"early"},{"1":"417","2":"420","3":"-3","4":"early"},{"1":"419","2":"420","3":"-1","4":"early"},{"1":"420","2":"390","3":"30","4":"late"},{"1":"420","2":"420","3":"0","4":"early"},{"1":"420","2":"420","3":"0","4":"early"},{"1":"421","2":"425","3":"-4","4":"early"},{"1":"422","2":"420","3":"2","4":"late"},{"1":"424","2":"415","3":"9","4":"late"},{"1":"424","2":"425","3":"-1","4":"early"},{"1":"424","2":"420","3":"4","4":"late"},{"1":"425","2":"390","3":"35","4":"late"},{"1":"425","2":"430","3":"-5","4":"early"},{"1":"427","2":"435","3":"-8","4":"early"},{"1":"429","2":"420","3":"9","4":"late"},{"1":"432","2":"420","3":"12","4":"late"},{"1":"432","2":"420","3":"12","4":"late"},{"1":"434","2":"435","3":"-1","4":"early"},{"1":"435","2":"441","3":"-6","4":"early"},{"1":"435","2":"435","3":"0","4":"early"},{"1":"439","2":"440","3":"-1","4":"early"},{"1":"440","2":"360","3":"80","4":"really late"},{"1":"442","2":"445","3":"-3","4":"early"},{"1":"443","2":"433","3":"10","4":"late"},{"1":"444","2":"450","3":"-6","4":"early"},{"1":"447","2":"405","3":"42","4":"late"},{"1":"448","2":"450","3":"-2","4":"early"},{"1":"449","2":"440","3":"9","4":"late"},{"1":"449","2":"449","3":"0","4":"early"},{"1":"449","2":"450","3":"-1","4":"early"},{"1":"450","2":"435","3":"15","4":"late"},{"1":"452","2":"450","3":"2","4":"late"},{"1":"452","2":"456","3":"-4","4":"early"},{"1":"452","2":"452","3":"0","4":"early"},{"1":"453","2":"455","3":"-2","4":"early"},{"1":"453","2":"457","3":"-4","4":"early"},{"1":"454","2":"420","3":"34","4":"late"},{"1":"454","2":"452","3":"2","4":"late"},{"1":"457","2":"465","3":"-8","4":"early"},{"1":"458","2":"465","3":"-7","4":"early"},{"1":"459","2":"465","3":"-6","4":"early"},{"1":"459","2":"455","3":"4","4":"late"},{"1":"460","2":"460","3":"0","4":"early"},{"1":"461","2":"463","3":"-2","4":"early"},{"1":"461","2":"460","3":"1","4":"late"},{"1":"463","2":"465","3":"-2","4":"early"},{"1":"464","2":"450","3":"14","4":"late"},{"1":"465","2":"450","3":"15","4":"late"},{"1":"465","2":"466","3":"-1","4":"early"},{"1":"467","2":"469","3":"-2","4":"early"},{"1":"470","2":"445","3":"25","4":"late"},{"1":"471","2":"480","3":"-9","4":"early"},{"1":"472","2":"480","3":"-8","4":"early"},{"1":"472","2":"480","3":"-8","4":"early"},{"1":"472","2":"465","3":"7","4":"late"},{"1":"474","2":"395","3":"79","4":"really late"},{"1":"474","2":"475","3":"-1","4":"early"},{"1":"475","2":"480","3":"-5","4":"early"},{"1":"475","2":"480","3":"-5","4":"early"},{"1":"475","2":"479","3":"-4","4":"early"},{"1":"477","2":"480","3":"-3","4":"early"},{"1":"477","2":"479","3":"-2","4":"early"},{"1":"478","2":"475","3":"3","4":"late"},{"1":"479","2":"485","3":"-6","4":"early"},{"1":"480","2":"490","3":"-10","4":"early"},{"1":"481","2":"450","3":"31","4":"late"},{"1":"481","2":"490","3":"-9","4":"early"},{"1":"484","2":"485","3":"-1","4":"early"},{"1":"486","2":"490","3":"-4","4":"early"},{"1":"487","2":"490","3":"-3","4":"early"},{"1":"488","2":"490","3":"-2","4":"early"},{"1":"488","2":"495","3":"-7","4":"early"},{"1":"489","2":"490","3":"-1","4":"early"},{"1":"490","2":"480","3":"10","4":"late"},{"1":"491","2":"495","3":"-4","4":"early"},{"1":"491","2":"495","3":"-4","4":"early"},{"1":"491","2":"500","3":"-9","4":"early"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  &lt;/script&gt;
&lt;/div&gt;

```
## # A tibble: 3 x 2
##   late_category      n
##           &lt;chr&gt;  &lt;int&gt;
## 1         early 200089
## 2          late  96359
## 3   really late  32073
```

---

class: dv

# group_by() and summarize()

* Often, data sets are grouped and aggregated to get a coarser level of insights

* Think _pivot tables_ from Excel

* In R, these manipulations are accomplished using _grouped data frames_.

![](img/group_summary.png)


---

class: dv

# group_by() and summarize()

* For `flights`, what if we wanted the average `distance` for each `month`?



```r
flights_late %&gt;%
  group_by(month) %&gt;%                      # Group rows by month 1, 2, ..., 12
  summarize(avg_distance = mean(distance), # For each group, avg distance
            avg_delay    = mean(delay))
```


```
## # A tibble: 12 x 3
##    month avg_distance avg_delay
##    &lt;int&gt;        &lt;dbl&gt;     &lt;dbl&gt;
##  1     1     1014.221 10.036665
##  2     2     1007.523 10.816843
##  3     3     1023.296 13.227076
##  4     4     1047.726 13.938038
##  5     5     1048.667 12.986859
##  6     6     1073.316 20.846332
##  7     7     1070.379 21.727787
##  8     8     1069.759 12.611040
##  9     9     1048.707  6.722476
## 10    10     1041.916  6.243988
## 11    11     1053.247  5.435362
## 12    12     1076.755 16.576688
```

---

class: dv

# group_by() and summarize()

![](./img/group_by.png)

---

class: dv

# Tidy data

* There are three interrelated rules which make a dataset tidy:

      1. Each _variable_ must have its own _column_.

      2. Each _observation_ must have its own _row_.
  
      3. Each _value_ must have its own _cell_.
    
![](./img/tidy.png)


---

class: dv

# Tidy VS Untidy example

* Not tidy! Think about performing a `group_by` to get the average de for each product. Can't group on columns!

&lt;br&gt;&lt;/br&gt;


```
## # A tibble: 6 x 6
##   scenario  year IM_Fixed_Annuity IM_Variable_Annuity RPS_Fixed_Annuity
##      &lt;dbl&gt; &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;
## 1        1     1         181893.9            685179.8          35324.75
## 2        1     2         145249.0            530600.0          37843.00
## 3        1     3         167350.3            594621.8         113321.81
## 4        1     4         129080.0            490597.3         104969.93
## 5        1     5         155391.4            700953.3         110358.50
## 6        2     1         255595.0            704294.8          87184.27
## # ... with 1 more variables: RPS_Variable_Annuity &lt;dbl&gt;
```


---

class: dv

# Tidying up - gather() and spread()

&lt;br&gt;&lt;/br&gt;

![](./img/gather.png)


---

class: dv

# Tidying up - gather() and spread()

* `gather()` multiple columns together


```r
de %&gt;% 
  gather(key = product, value = de, -scenario, -year)
```


```
## # A tibble: 60 x 4
##    scenario  year          product       de
##       &lt;dbl&gt; &lt;dbl&gt;            &lt;chr&gt;    &lt;dbl&gt;
##  1        1     1 IM_Fixed_Annuity 181893.9
##  2        1     2 IM_Fixed_Annuity 145249.0
##  3        1     3 IM_Fixed_Annuity 167350.3
##  4        1     4 IM_Fixed_Annuity 129080.0
##  5        1     5 IM_Fixed_Annuity 155391.4
##  6        2     1 IM_Fixed_Annuity 255595.0
##  7        2     2 IM_Fixed_Annuity 216497.4
##  8        2     3 IM_Fixed_Annuity 180066.7
##  9        2     4 IM_Fixed_Annuity 110949.7
## 10        2     5 IM_Fixed_Annuity 158623.1
## 11        3     1 IM_Fixed_Annuity 256347.5
## 12        3     2 IM_Fixed_Annuity 224788.5
## # ... with 48 more rows
```

---

class: dv

# Tidying up - gather() and spread()


```r
library(FinCal)
de %&gt;% 
  gather(key = product, value = de, -scenario, -year) %&gt;%
  group_by(product, scenario) %&gt;%
  summarise(pvde = pv.uneven(r = .05, cf = -de))
```


```
## # A tibble: 12 x 3
## # Groups:   product [?]
##                 product scenario      pvde
##                   &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
##  1     IM_Fixed_Annuity        1  677488.7
##  2     IM_Fixed_Annuity        2  810905.6
##  3     IM_Fixed_Annuity        3  782026.7
##  4  IM_Variable_Annuity        1 2600309.5
##  5  IM_Variable_Annuity        2 2821120.7
##  6  IM_Variable_Annuity        3 2191810.4
##  7    RPS_Fixed_Annuity        1  338686.8
##  8    RPS_Fixed_Annuity        2  441036.4
##  9    RPS_Fixed_Annuity        3  436270.0
## 10 RPS_Variable_Annuity        1  385174.3
## 11 RPS_Variable_Annuity        2  403285.7
## 12 RPS_Variable_Annuity        3  342334.9
```

---

class: dv

# Tidying up - gather() and spread() 

* `spread()` is the complement to `gather()`

![](img/spread.png)


---

class: dv

# Tidying up - gather() and spread()

* `spread()` is the complement to `gather()`


```r
library(FinCal)
de %&gt;% 
  gather(key = product, value = de, -scenario, -year) %&gt;%
  group_by(product, scenario) %&gt;%
  summarise(pvde = pv.uneven(r = .05, cf = -de)) %&gt;%
  spread(key= product, value = pvde)
```

```
## # A tibble: 3 x 5
##   scenario IM_Fixed_Annuity IM_Variable_Annuity RPS_Fixed_Annuity
## *    &lt;dbl&gt;            &lt;dbl&gt;               &lt;dbl&gt;             &lt;dbl&gt;
## 1        1         677488.7             2600310          338686.8
## 2        2         810905.6             2821121          441036.4
## 3        3         782026.7             2191810          436270.0
## # ... with 1 more variables: RPS_Variable_Annuity &lt;dbl&gt;
```

---

class: dv

# Wrap up

* What is a tibble / data frame?

* How to install a package?

--

* Basic visualization with ggplot2 

  * Scatter plot
  
  * Line graph
  
  * Bar chart

* Faceting

--

* Data manipulation

  * mutate
  
  * group_by + summarize
  
  * gather + spread

---

class: dv

# Thank you!

* Help document with more R references

* Stack Overflow + Google solve everything

* I'm here until tomorrow
    </textarea>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
